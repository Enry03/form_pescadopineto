<script>
  // CONFIGURA QUI I TUOI DATI SUPABASE
  const SUPABASE_URL = "https://wvbgpnepliihplacnlmp.supabase.co";
  const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind2YmdwbmVwbGlpaHBsYWNubG1wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQwODU0OTUsImV4cCI6MjA2OTY2MTQ5NX0.EkTXvzCacTTqknOZhZrzBU7Ml0RzVHnrOIS2x1dRBBI";

  const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  async function loadMenu() {
    const container = document.getElementById("menu-container");

    // 1️⃣ Leggi categorie ordinate
    const { data: categories, error: catErr } = await supabase
      .from("categorie_menu")
      .select("*")
      .order("ordinamento", { ascending: true });

    // 2️⃣ Leggi tutti i piatti
    const { data: items, error: itemErr } = await supabase
      .from("piatti")
      .select("*")
      .order("nome", { ascending: true });

    if (catErr || itemErr) {
      container.innerHTML = "Errore nel caricamento del menù.";
      console.error(catErr || itemErr);
      return;
    }

    container.innerHTML = "";

    // 3️⃣ Stampa categorie e piatti
    categories.forEach(cat => {
      const catEl = document.createElement("div");
      catEl.className = "category";
      catEl.textContent = cat.nome;
      container.appendChild(catEl);

      items
        .filter(i => i.categoria_id === cat.id)
        .forEach(i => {
          const el = document.createElement("div");
          el.className = "item";
          el.innerHTML = `
            <strong>${i.nome}</strong>
            <span class="price">€ ${i.prezzo.toFixed(2)}</span>
          `;
          container.appendChild(el);
        });
    });
  }

  loadMenu();
</script>
