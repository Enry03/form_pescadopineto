<!-- 1️⃣ Carica la libreria Supabase PRIMA di tutto -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>

<script>
  // 2️⃣ Poi puoi inizializzare Supabase
  const SUPABASE_URL = "https://wvbgpnepliihplacnlmp.supabase.co";
  const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind2YmdwbmVwbGlpaHBsYWNubG1wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQwODU0OTUsImV4cCI6MjA2OTY2MTQ5NX0.EkTXvzCacTTqknOZhZrzBU7Ml0RzVHnrOIS2x1dRBBI";

  const client = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  async function loadMenu() {
    const container = document.getElementById("menu-container");

    // Leggi categorie
    const { data: categories, error: catErr } = await client
      .from("categorie_menu")
      .select("*")
      .order("ordinamento", { ascending: true });

    // Leggi piatti
    const { data: items, error: itemErr } = await client
      .from("piatti")
      .select("*")
      .order("nome", { ascending: true });

    if (catErr || itemErr) {
      container.innerHTML = "Errore nel caricamento del menù.";
      console.error(catErr || itemErr);
      return;
    }

    container.innerHTML = "";

    // Stampa categorie
    categories.forEach(cat => {
      const catEl = document.createElement("div");
      catEl.className = "category";
      catEl.textContent = cat.nome;
      container.appendChild(catEl);

      // Stampa piatti della categoria
      items
        .filter(i => i.categoria_id === cat.id)
        .forEach(i => {
          const el = document.createElement("div");
          el.className = "item";
          el.innerHTML = `
            <strong>${i.nome}</strong>
            <span class="price">€ ${i.prezzo.toFixed(2)}</span>
          `;
          container.appendChild(el);
        });
    });
  }

  loadMenu();
</script>
